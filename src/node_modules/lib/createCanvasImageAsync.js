import {
  RESOLUTION,
  PIXEL_SIZE
} from 'config/constants'

const SIZE = PIXEL_SIZE * RESOLUTION

export const createCanvasImage = (drawingCallback = () => {}) => {
  let canvas = document.createElement('canvas')

  canvas.width  = SIZE
  canvas.height = SIZE

  let ctx = canvas.getContext('2d')

  drawingCallback(ctx)

  let image = new Image()

  image.src = canvas.toDataURL()

  return image
}

export const createCanvasImageAsync = (...args) => new Promise(resolve => {
  let image = createCanvasImage(...args)

  image.onload = function() { resolve(image) }
})

export default createCanvasImageAsync