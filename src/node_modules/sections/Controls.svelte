<script>
  import { project } from 'store'

  let animationId = null


  function play() {
    let { frames, frameIndex } = $project

    animationId = setTimeout(() => {
      $project.frameIndex = (frameIndex + 1) % frames.length

      requestAnimationFrame(play)
    }, 1000 / $project.frameRate)
  }

  // Sometimes fails.. TODO: fix bug
  function pause() {
    clearTimeout(animationId)

    animationId = null
  }

</script>

<div class="flex justify-center">
  <button class="focus:outline-none bg-green-600 text-white px-3 py-1 text-sm" on:click|stopPropagation={ () => animationId ? pause() : play() }>
    { animationId ? 'Pause' : 'Play' }
  </button>
</div>