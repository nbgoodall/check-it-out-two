<script>
  import { project } from 'store'

  function setFrameRate(evt) {
    $project.setFrameRate(evt.target.value)
  }

  function setRepeat(evt) {
    $project.currentFrame.repeat = Math.max(0, evt.target.value)
  }

  let repeatTime;

  $: {
    let ms = ($project.currentFrame.repeat * 1000 / $project.frameRate) || 0

    repeatTime = ms >= 1000 ? `${ (ms / 1000).toFixed(1) }s` : `${ ms.toFixed(0) }ms`
  }
</script>

<div class="table max-w-full w-56">
  <div class="table-row-group">
    <div class="table-row">
      <div class="table-cell text-gray-800 text-sm">FPS</div>

      <div class="table-cell text-gray-800 text-sm">
        <input type="number" min="1" max="60" step="0.25" bind:value={ $project.frameRate } on:change|stopPropagation={ setFrameRate }
          class="text-xl w-full text-right appearance-none border-0 bg-transparent focus:outline-none"
        >
      </div>
    </div>

    <div class="table-row pt-5 mto">
      <div class="table-cell text-gray-800 text-sm">Repeat <span class="text-gray-500">({ repeatTime })</span></div>

      <div class="table-cell text-gray-800 text-sm">
        <input type="number" min="0" max="60" bind:value={ $project.currentFrame.repeat } on:change|stopPropagation={ setRepeat }
          class="text-xl w-full text-right appearance-none border-0 bg-transparent focus:outline-none"
        >
      </div>
    </div>
  </div>
</div>
<!--
<div class="flex items-center text-lg text-gray-500 select-none">
  FPS:&nbsp;
  <input type="number" min="1" max="60" step="0.25" bind:value={ $project.frameRate } on:change|stopPropagation={ setFrameRate }
    class="text-xl text-gray-800 w-auto appearance-none border-0 bg-transparent focus:outline-none"
  >
</div>

<div class="flex items-center text-lg text-gray-500 select-none">
  Repeat:&nbsp;
  <input type="number" min="0" max="60" bind:value={ $project.currentFrame.repeat } on:change|stopPropagation={ setRepeat }
    class="text-xl text-gray-800 w-auto appearance-none border-0 bg-transparent focus:outline-none"
  > (10s)
</div> -->