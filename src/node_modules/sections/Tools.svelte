<script>
  import { project } from 'store'

  import tools from 'tools'

  function addColor(evt) {
    let color = evt.target.value.toUpperCase()

    $project.addColor(color)
  }

  const setTool = name => () => {
    let _tool = tools[name]

    if (_tool) {
      $project.tool = _tool
      _tool.project = $project
    }
  }

  $: tool = $project.tool
</script>

<div class="flex flex-col items-end">
  <div class="flex flex-row items-start">
    <div class="overflow-x-scroll overflow-y-hidden max-w-sm flex flex-row-reverse pb-4">
      <div class="border-2 flex items-center flex-row-reverse px-px py-px">
        <!-- <div class="flex-shrink-0 w-1 h-1 -ml-px"></div> -->

        {#each $project.colors as color }
          <div class="relative flex-shrink-0 w-6 h-6 mx-px" style="background-color: { color };" on:click={ () => $project.color = color }>

            {#if color == 'transparent' }
              <img src="/images/grid/mini_transparent.svg" class="absolute inset-0" alt="Transparent checkered grid.">
            {/if}

          </div>
        {/each}

        <!-- <div class="flex-shrink-0 w-1 h-1 -mr-1"></div> -->
      </div>
    </div>

    <div class="relative w-8 h-8 border-2 border-white ml-2 shadow-md">
      <input
        type="color"
        class="absolute inset-0 block w-full h-full appearance-none focus:outline-none"
        value={ $project.color == 'transparent' ? '#FFFFFF' : $project.color }
        on:change={ addColor }
      />

      {#if $project.color == 'transparent' }
        <img src="/images/grid/mini_transparent.svg" class="absolute inset-0" alt="Transparent checkered grid.">
      {/if}
    </div>
  </div>

<!--   <button class="bg-white h-8 w-8 mt-3 focus:outline-none flex justify-center items-center border-2 border-green-400">
    <svg class="fill-current text-gray-800 w-5 h-5" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
      <path  d="M10.8601685,11.9953299l2.5251465,6.0802317L11.1703491,19l-2.5252075-6.050354L5,16.6248779V1.1005249l10.9461327,10.8882742L10.8601685,11.9953299z"/>
    </svg>
  </button> -->

  <!-- Brush -->
  <button on:click={ setTool('brush') } class="bg-white h-8 w-8 mt-3 focus:outline-none flex justify-center items-center border-2 text-gray-900 { tool.name == 'brush' && 'border-green-400' }">
    <svg class="fill-current w-5 h-5 { tool.name != 'brush' && 'opacity-50' }" viewBox="0 0 280 280" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M240 0H280V40H260V60H240V80H220V100H200V120H180V140H160V160H140V180H120V200H100V220H80V280H40V240H0V200H60V180H80V160H100V140H120V120H140V100H160V80H180V60H200V40H220V20H240V0Z" fill="black"/>
      <path d="M0 240H40V280H0V240Z" fill="{ $project.color }" />
    </svg>


  </button>

  <!-- Rectangle -->
  <button on:click={ setTool('rectangle') } class="bg-white h-8 w-8 mt-2 focus:outline-none flex justify-center items-center border-2 text-gray-900 { tool.name == 'rectangle' && 'border-green-400' }">
    <svg class="fill-current w-5 h-5 { tool.name != 'rectangle' && 'opacity-50' }" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="100" height="100" fill={ $project.color } />
    </svg>
  </button>

  <!-- Fill -->

  <button on:click={ setTool('fill') } class="bg-white h-8 w-8 mt-2 focus:outline-none flex justify-center items-center border-2 text-gray-500 { tool.name == 'fill' && 'border-green-400 text-gray-900' }">
    <svg class="fill-current w-5 h-5 { tool.name != 'fill' && 'opacity-50' }" viewBox="0 0 280 240" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M140 0H160V20H180V40H200V60H220V80H240V100H220V120H180V140H240V120H280V180H260V200H240V220H220V240H160V220H140V200H120V180H100V160H80V140H60V120H40V100H60V80H80V60H100V40H120V20H140V0Z" fill="black"/>
      <path d="M40 40H100V60H80V80H60V100H40V180H20V160H0V80H20V60H40V40Z" fill={ $project.color } />
      <path d="M200 40H240V80H220V60H200V40Z" fill="#DDDDDD"/>
      <path d="M240 60H260V120H240V140H180V120H220V100H240V60Z" fill="#AAAAAA"/>
    </svg>


  </button>

  <!-- Line -->

  <button on:click={ setTool('line') } class="bg-white h-8 w-8 mt-2 focus:outline-none flex justify-center items-center border-2 text-gray-500 { tool.name == 'line' && 'border-green-400 text-gray-900' }">
   <svg class="fill-current w-5 h-5" viewBox="0 0 140 140" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M140 0H120V20H140V0Z" />
      <path d="M120 20H100V40H120V20Z" />
      <path d="M100 40H80V60H100V40Z" />
      <path d="M80 60H60V80H80V60Z" />
      <path d="M60 80H40V100H60V80Z" />
      <path d="M40 100H20V120H40V100Z" />
      <path d="M20 120H0V140H20V120Z" />
    </svg>
  </button>

  <!-- Ellipse -->

  <button on:click={ setTool('ellipse') } class="bg-white h-8 w-8 mt-2 focus:outline-none flex justify-center items-center border-2 text-gray-500 { tool.name == 'ellipse' && 'border-green-400 text-gray-900' }">
   <svg class="fill-current w-5 h-5" viewBox="0 0 140 140" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M60 0H40V20H60V0Z" />
      <path d="M80 0H60V20H80V0Z" />
      <path d="M100 0H80V20H100V0Z" />
      <path d="M40 20H20V40H40V20Z" />
      <path d="M120 20H100V40H120V20Z" />
      <path d="M20 40H0V60H20V40Z" />
      <path d="M140 40H120V60H140V40Z" />
      <path d="M20 60H0V80H20V60Z" />
      <path d="M140 60H120V80H140V60Z" />
      <path d="M20 80H0V100H20V80Z" />
      <path d="M140 80H120V100H140V80Z" />
      <path d="M40 100H20V120H40V100Z" />
      <path d="M120 100H100V120H120V100Z" />
      <path d="M60 120H40V140H60V120Z" />
      <path d="M80 120H60V140H80V120Z" />
      <path d="M100 120H80V140H100V120Z" />
    </svg>
  </button>
</div>