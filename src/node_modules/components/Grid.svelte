<script context="module">
  import { PIXEL_SIZE, RESOLUTION } from 'config/constants'

  const SIZE = PIXEL_SIZE * RESOLUTION

  const SCALE = window.devicePixelRatio

  let gridImage = new Image()

  function drawGrid(ctx) {
    for (let x = 0; x <= SIZE; x += PIXEL_SIZE) {
      ctx.moveTo(x, 0)
      ctx.lineTo(x, SIZE)
    }

    for (var y = 0; y <= SIZE; y += PIXEL_SIZE) {
      ctx.moveTo(0, y)
      ctx.lineTo(SIZE, y)
    }

    ctx.strokeStyle = '#CBD5E0'
    ctx.stroke()

    ctx.strokeRect(0, 0, 2 * SIZE, 2 * SIZE)
  }

  function createGrid() {
    let canvas = document.createElement('canvas')

    canvas.width  = SIZE * SCALE
    canvas.height = SIZE * SCALE

    let ctx = canvas.getContext('2d')

    ctx.scale(SCALE, SCALE)

    drawGrid(ctx)

    gridImage.src = canvas.toDataURL()
  }

  createGrid()
</script>

<img src={ gridImage.src } class="absolute inset-0 pointer-events-none">